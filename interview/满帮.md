# 满帮面试-JVM部分

疯狂问jvm

- JVM内存划分

堆（线程共享）和虚拟机栈、本地方法栈、程序计数器（线程私有）。

- 堆的内存划分？
    - 新生代，老生代，元空间（元空间是直接内存）
    - 对象增加到15岁，移动到老生代。
- 堆外内存是直接内存吗？

  堆外内存又叫直接内存，是和操作系统内存直接挂钩的，堆外内存不受jvm的管制。

- 垃圾回收算法？
    - 标记清除、标记整理、标记复制
- jdk1.8默认垃圾回收算法？
    - JDK1.8 默认使用的是 Parallel Scavenge(新生代) + Parallel Old（老生代）
    - Parallel Scavenge **收集器关注点是吞吐量（高效率的利用 CPU）。所谓吞吐量就是 CPU 中用于运行用户代码的时间与 CPU 总消耗时间的比值**。 Parallel Scavenge 收集器提供了很多参数供用户找到最合适的停顿时间或最大吞吐量，如果对于收集器运作不太了解，手工优化存在困难的时候，使用 Parallel Scavenge 收集器配合自适应调节策略，把内存管理优化交给虚拟机去完成也是一个不错的选择。
    - **新生代采用标记-复制算法，老年代采用标记-整理算法。**
    - Parallel Old 收集器：**Parallel Scavenge 收集器的老年代版本**。使用多线程和“标记-整理”算法。在注重吞吐量以及 CPU 资源的场合，都可以优先考虑 Parallel Scavenge 收集器和 Parallel Old 收集器。
    - JDK1.9开始默认垃圾回收算法使用**G1**

  ### **G1垃圾回收器**

  G1收集器与前面的CMS收集器相比有两个显著的改进：一是G1收集器是基于“**标记-整理**”算法实现的收集器，也就是说它不会产生空间碎片。二是它可以非常精确地控制停顿，既能让使用者明确指定在一个长度为M毫秒的时间片段内，消耗在垃圾收集上的时间不得超过N毫秒。
  G1收集器可以实现在基本不牺牲吞吐量的前提下完成低停顿的内存回收，这是由于它能够极力地避免全区域的垃圾收集，之前的收集器进行收集的范围都是整个新生代或老年代，而G1将整个Java堆（包括新生代、老年代）划分为多个大小固定的独立区域（Region），并且跟踪这些区域里面的垃圾堆积程度，在后台维护一个优先列表，每次根据允许的收集时间，优先回收垃圾最多的区域（这就是Garbage First名称的来由）。区域划分及有优先级的区域回收，保证了G1收集器在有限的时间内可以获得最高的收集效率。

  ### G1和CMS垃圾回收器的区别？

  CMS是JDK1.5引入，并在JDK9标记为废弃。

  CMS回收分为，初始标记、并发标记、重新标记、并发清除。

  （1）CMS收集器对处理器资源⾮常敏感。 （2）CMS⽆法处理浮动垃圾。 （3）CMS是基于标记-清除算法，会产⽣⼤量的空间碎⽚。

- 双亲委派机制?
- 代理模式和装饰器模式的区别，举例说明
- 为什么要用消息队列，而不是redis缓存之类的。
- 接口可以多继承吗？
    - 可以，接口允许继承多个接口。

    ```java
    public interface ApplicationContext extends EnvironmentCapable, ListableBeanFactory, HierarchicalBeanFactory,
            MessageSource, ApplicationEventPublisher, ResourcePatternResolver { }
    ```

- 多态
    - 运行时多态
        - 子类重写父类的方法，并且用父类的对象指向子类的变量。在运行时候决定调用哪一个方法
    - 编译时多态
        - 重载方法
- Java创建对象的几种方法？
    - new关键字
    - 反射创建
    - Clone
    - 反序列化

### **会造成OOM的区域？**

除了程序计数器，其他的部分都会发生 OOM。

1. 堆。 通常发生的 OOM 都会发生在堆中，最常⻅的可能导致 OOM 的原因就是内存泄漏。
2. JVM虚拟机栈和本地方法栈。 当我们写一个递归方法，这个递归方法没有循环终止条件，最终会导 致 StackOverflow 的错误。当然，如果栈空间扩展失败，也是会发生 OOM 的。
3. 方法区。方法区现在基本上不太会发生 OOM，但在早期内存中加载的类信息过多的情况下也是会发生OOM 的。

### **Java的内存模型？**

线程共享的是堆空间，线程私有的是栈空间（程序计数器，虚拟机栈<由栈帧组成，操作数，方法返回地址>、本地方法栈）

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/548d0681-a985-47de-b8ab-bb875e7a65ef/Untitled.png)

到底